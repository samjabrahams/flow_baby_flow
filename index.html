<!DOCTYPE html>
<html>
<head>
	<style>
		body, html {
			height: 100%;
			margin: 0;
			padding: 0;
		}

		body {
			background-color: #000;
		}

		#map {
			height: 700px;
		}
	</style>
	<script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.7/mapbox.js'></script>
	<script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

	<link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.7/mapbox.css' rel='stylesheet' />
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
	<script>
		var geojson;

		var colorIndex = 0;

		var colorArray = [
			'#D1000F',
			'#C0001A',
			'#B00126',
			'#A00231',
			'#8F033D',
			'#7F0448',
			'#6F0454',
			'#5E055F',
			'#4E066B',
			'#3E0776',
			'#2E0882'];

		function style(feature) {
			return {
				fillColor: '#882134',
				weight: 0,
				opacity: 0.7,
				color: 'white',
				dashArray: '3',
				fillOpacity: 0.7
			};
		}

		function highlightFeature(e) {
			var layer = e.target;

			layer.setStyle({
				weight: 2,
				color: '#F00',
				fillOpacity: 1.0
			});

			if (!L.Browser.ie && !L.Browser.opera) {
				layer.bringToFront();
			}
		}

		function resetHighlight(e) {
			geojson.resetStyle(e.target);
		}

		function onEachFeature(feature, layer) {
			layer.on({
				mouseover: highlightFeature,
				mouseout: resetHighlight
			});
		}

		function attachDataToMap(dataURL, map) {
			$.getJSON(dataURL, function(data) {
				console.log("setting geojson!");
				geojson = L.geoJson(data, {
					style: style,
					onEachFeature: onEachFeature
				}).addTo(map);
			});
		}

		function changeColorTest(geojson) {
			if (colorIndex >= colorArray.length || colorIndex < 0) {
				console.log("resetting index!");
				colorIndex = 0;
			}

			console.log("color is " + colorArray[colorIndex]);

			geojson.setStyle({
				fillColor: colorArray[colorIndex]
			});

			colorIndex++;
		}

		window.onload = function() {
			var map = L.map('map').setView([39.52, -98.4], 5);

			L.tileLayer('https://{s}.tiles.mapbox.com/v4/samjabrahams.ln53g9ef/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoic2FtamFicmFoYW1zIiwiYSI6IlFYaEFqQWcifQ.wKho1oe6MY2xAtQ1uOYWrg').addTo(map);

			attachDataToMap('countyGeo.json', map);			

			$('#remove').click(function() {
				geojson.clearLayers();
				setTimeout(function() {
					attachDataToMap('countyGeo.json', map)
				}, 4000 );
			});

			$('#color').click(function() {
				setInterval(function() {
					changeColorTest(geojson);
				}, 17);
			});

		}		
	</script>

</head>
<body>
	<div id="map"></div>
	<button type="button" id="remove" value="clear">Clear the JSON Layer!</button>
	<button type="button" id="color" value="color">Begin the coloration!</button>
</body>
	
</html>
